import { dom, Fragment, JSXComponent } from "./mact/index.js";
import { Item } from "./components/Item";
const initState = {
  state: {},
  setState: function (obj, func = null) {
    console.log("old state", this.state);
    this.state = { ...this.state,
      ...obj
    };
    console.log("new state", this.state);

    if (func == null) {
      BootJSX(this.state);
    } else {
      func(obj);
    }
  }
};

const OrderHistoryContaier = props => {
  initState.state = { ...props
  };

  let clicked = item => {
    alert(item);
  };

  let search = e => {
    console.log(e, "e");
    initState.setState({
      name: e.target.value
    });
  };

  let ToggleList = e => {
    if ($("#list").is(":visible")) {
      initState.setState({
        items: [...props.items, ...[4, 5, 6, 7]]
      });
    }

    $("#list").slideToggle(1000);
  };

  return dom("div", null, dom(OrderHistorySearchV2, {
    name: props.name,
    search: search
  }), dom("div", null, dom("button", {
    class: "btn",
    onClick: ToggleList
  }, "Toggle With JQuery"), dom("h3", null, "Example heading ", dom("span", {
    class: "label label-default"
  }, "New")), dom("p", null, "This is a paragraph in a fragment"), dom('Fragment', null, dom("h1", null, "Hello ", props.name), dom("hr", null), dom("spam", null, " ", props.DisplayName != null ? props.DisplayName : "")), props.showItems ? dom(ItemList, {
    items: props.items,
    clicked: clicked
  }) : dom('Fragment', null)));
};

const ItemList = props => {
  return dom("ul", {
    id: "list"
  }, props.items.map(item => dom(Item, {
    clicked: props.clicked,
    item: item
  })));
};

function SetCaretAtEnd(elem) {
  if (elem === null) return;
  var elemLen = elem.value.length; // For IE Only

  if (document.selection) {
    // Set focus
    elem.focus(); // Use IE Ranges

    var oSel = document.selection.createRange(); // Reset position to 0 & then set at end

    oSel.moveStart("character", -elemLen);
    oSel.moveStart("character", elemLen);
    oSel.moveEnd("character", 0);
    oSel.select();
  } else if (elem.selectionStart || elem.selectionStart == "0") {
    console.log(elem); // Firefox/Chrome

    elem.selectionStart = elemLen;
    elem.selectionEnd = elemLen;
    elem.focus();
  } // if

}

const isTextSelected = input => {
  if (!input) return false;
  var selecttxt = "";

  if (window.getSelection) {
    selecttxt = window.getSelection();
  } else if (document.getSelection) {
    selecttxt = document.getSelection();
  } else if (document.selection) {
    selecttxt = document.selection.createRange().text;
  }

  if (selecttxt == "") {
    return false;
  }

  return true;
};

function OrderHistorySearch(props) {
  setTimeout(() => {
    SetCaretAtEnd(document.querySelector("#search"));
  }, 150);
  return dom("input", {
    id: "search",
    type: "search",
    placeholder: "search something",
    value: props.name,
    onKeyUp: function (e) {
      let val = e.target.value;
      props.search({
        target: {
          value: val
        }
      });
    }
  });
}

function debounce(func, wait, immediate) {
  var timeout;
  return function executedFunction() {
    var context = this;
    var args = arguments;

    var later = function () {
      timeout = null;
      if (!immediate) func.apply(context, args);
    };

    var callNow = immediate && !timeout;
    clearTimeout(timeout);
    timeout = setTimeout(later, wait);
    if (callNow) func.apply(context, args);
  };
}

class OrderHistorySearchV2 extends JSXComponent {
  render(props) {
    setTimeout(() => {
      SetCaretAtEnd(document.querySelector("#search"));
    }, 10);
    return dom("input", {
      id: "search",
      type: "search",
      placeholder: "search something",
      style: {
        width: "100%"
      },
      value: props.name,
      onKeyUp: debounce(function (e) {
        if (!isTextSelected(e)) {
          props.search(e);
        }
      }, 500)
    });
  }

}

export const BootJSX = (props, container = "root") => {
  document.getElementById(container).innerHTML = "";
  document.getElementById(container).appendChild(dom(OrderHistoryContaier, props));
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2pzeC9pbmRleC5qcyJdLCJuYW1lcyI6WyJkb20iLCJGcmFnbWVudCIsIkpTWENvbXBvbmVudCIsIkl0ZW0iLCJpbml0U3RhdGUiLCJzdGF0ZSIsInNldFN0YXRlIiwib2JqIiwiZnVuYyIsImNvbnNvbGUiLCJsb2ciLCJCb290SlNYIiwiT3JkZXJIaXN0b3J5Q29udGFpZXIiLCJwcm9wcyIsImNsaWNrZWQiLCJpdGVtIiwiYWxlcnQiLCJzZWFyY2giLCJlIiwibmFtZSIsInRhcmdldCIsInZhbHVlIiwiVG9nZ2xlTGlzdCIsIiQiLCJpcyIsIml0ZW1zIiwic2xpZGVUb2dnbGUiLCJEaXNwbGF5TmFtZSIsInNob3dJdGVtcyIsIkl0ZW1MaXN0IiwibWFwIiwiU2V0Q2FyZXRBdEVuZCIsImVsZW0iLCJlbGVtTGVuIiwibGVuZ3RoIiwiZG9jdW1lbnQiLCJzZWxlY3Rpb24iLCJmb2N1cyIsIm9TZWwiLCJjcmVhdGVSYW5nZSIsIm1vdmVTdGFydCIsIm1vdmVFbmQiLCJzZWxlY3QiLCJzZWxlY3Rpb25TdGFydCIsInNlbGVjdGlvbkVuZCIsImlzVGV4dFNlbGVjdGVkIiwiaW5wdXQiLCJzZWxlY3R0eHQiLCJ3aW5kb3ciLCJnZXRTZWxlY3Rpb24iLCJ0ZXh0IiwiT3JkZXJIaXN0b3J5U2VhcmNoIiwic2V0VGltZW91dCIsInF1ZXJ5U2VsZWN0b3IiLCJ2YWwiLCJkZWJvdW5jZSIsIndhaXQiLCJpbW1lZGlhdGUiLCJ0aW1lb3V0IiwiZXhlY3V0ZWRGdW5jdGlvbiIsImNvbnRleHQiLCJhcmdzIiwiYXJndW1lbnRzIiwibGF0ZXIiLCJhcHBseSIsImNhbGxOb3ciLCJjbGVhclRpbWVvdXQiLCJPcmRlckhpc3RvcnlTZWFyY2hWMiIsInJlbmRlciIsIndpZHRoIiwiY29udGFpbmVyIiwiZ2V0RWxlbWVudEJ5SWQiLCJpbm5lckhUTUwiLCJhcHBlbmRDaGlsZCJdLCJtYXBwaW5ncyI6IkFBQUEsU0FBU0EsR0FBVCxFQUFjQyxRQUFkLEVBQXdCQyxZQUF4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QUMyQixjQUFjLENBQUMzQixDQUFELENBQW5CLEVBQXdCO0FBQ3RCTCxVQUFBQSxLQUFLLENBQUNJLE1BQU4sQ0FBYUMsQ0FBYjtBQUNEO0FBQ0YsT0FKZ0IsRUFJZCxHQUpjO0FBTm5CLE1BREY7QUFjRDs7QUFuQjZDOztBQXNCaEQsT0FBTyxNQUFNUCxPQUFPLEdBQUcsQ0FBQ0UsS0FBRCxFQUFReUQsU0FBUyxHQUFHLE1BQXBCLEtBQStCO0FBQ3BEbkMsRUFBQUEsUUFBUSxDQUFDb0MsY0FBVCxDQUF3QkQsU0FBeEIsRUFBbUNFLFNBQW5DLEdBQStDLEVBQS9DO0FBQ0FyQyxFQUFBQSxRQUFRLENBQ0xvQyxjQURILENBQ2tCRCxTQURsQixFQUVHRyxXQUZILENBRWUsSUFBQyxvQkFBRCxFQUEwQjVELEtBQTFCLENBRmY7QUFHRCxDQUxNIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZG9tLCBGcmFnbWVudCwgSlNYQ29tcG9uZW50IH0gZnJvbSBcIi4vbWFjdC9pbmRleC5qc1wiO1xyXG5cclxuaW1wb3J0IHsgSXRlbSB9IGZyb20gXCIuL2NvbXBvbmVudHMvSXRlbVwiO1xyXG5cclxuY29uc3QgaW5pdFN0YXRlID0ge1xyXG4gIHN0YXRlOiB7fSxcclxuICBzZXRTdGF0ZTogZnVuY3Rpb24gKG9iaiwgZnVuYyA9IG51bGwpIHtcclxuICAgIGNvbnNvbGUubG9nKFwib2xkIHN0YXRlXCIsIHRoaXMuc3RhdGUpO1xyXG4gICAgdGhpcy5zdGF0ZSA9IHsgLi4udGhpcy5zdGF0ZSwgLi4ub2JqIH07XHJcbiAgICBjb25zb2xlLmxvZyhcIm5ldyBzdGF0ZVwiLCB0aGlzLnN0YXRlKTtcclxuICAgIGlmIChmdW5jID09IG51bGwpIHtcclxuICAgICAgQm9vdEpTWCh0aGlzLnN0YXRlKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGZ1bmMob2JqKTtcclxuICAgIH1cclxuICB9LFxyXG59O1xyXG5cclxuY29uc3QgT3JkZXJIaXN0b3J5Q29udGFpZXIgPSAocHJvcHMpID0+IHtcclxuICBpbml0U3RhdGUuc3RhdGUgPSB7IC4uLnByb3BzIH07XHJcbiAgbGV0IGNsaWNrZWQgPSAoaXRlbSkgPT4ge1xyXG4gICAgYWxlcnQoaXRlbSk7XHJcbiAgfTtcclxuICBsZXQgc2VhcmNoID0gKGUpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKGUsIFwiZVwiKTtcclxuICAgIGluaXRTdGF0ZS5zZXRTdGF0ZSh7IG5hbWU6IGUudGFyZ2V0LnZhbHVlIH0pO1xyXG4gIH07XHJcblxyXG4gIGxldCBUb2dnbGVMaXN0ID0gKGUpID0+IHtcclxuICAgIGlmICgkKFwiI2xpc3RcIikuaXMoXCI6dmlzaWJsZVwiKSkge1xyXG4gICAgICBpbml0U3RhdGUuc2V0U3RhdGUoeyBpdGVtczogWy4uLnByb3BzLml0ZW1zLCAuLi5bNCwgNSwgNiwgN11dIH0pO1xyXG4gICAgfVxyXG5cclxuICAgICQoXCIjbGlzdFwiKS5zbGlkZVRvZ2dsZSgxMDAwKTtcclxuICB9O1xyXG4gIHJldHVybiAoXHJcbiAgICA8ZGl2PlxyXG4gICAgICA8T3JkZXJIaXN0b3J5U2VhcmNoVjIgbmFtZT17cHJvcHMubmFtZX0gc2VhcmNoPXtzZWFyY2h9IC8+XHJcbiAgICAgIDxkaXY+XHJcbiAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImJ0blwiIG9uQ2xpY2s9e1RvZ2dsZUxpc3R9PlxyXG4gICAgICAgICAgVG9nZ2xlIFdpdGggSlF1ZXJ5XHJcbiAgICAgICAgPC9idXR0b24+XHJcbiAgICAgICAgPGgzPlxyXG4gICAgICAgICAgRXhhbXBsZSBoZWFkaW5nIDxzcGFuIGNsYXNzPVwibGFiZWwgbGFiZWwtZGVmYXVsdFwiPk5ldzwvc3Bhbj5cclxuICAgICAgICA8L2gzPlxyXG4gICAgICAgIDxwPlRoaXMgaXMgYSBwYXJhZ3JhcGggaW4gYSBmcmFnbWVudDwvcD5cclxuICAgICAgICA8PlxyXG4gICAgICAgICAgPGgxPkhlbGxvIHtwcm9wcy5uYW1lfTwvaDE+XHJcblxyXG4gICAgICAgICAgPGhyIC8+XHJcbiAgICAgICAgICA8c3BhbT4ge3Byb3BzLkRpc3BsYXlOYW1lICE9IG51bGwgPyBwcm9wcy5EaXNwbGF5TmFtZSA6IFwiXCJ9PC9zcGFtPlxyXG4gICAgICAgIDwvPlxyXG5cclxuICAgICAgICB7cHJvcHMuc2hvd0l0ZW1zID8gKFxyXG4gICAgICAgICAgPEl0ZW1MaXN0IGl0ZW1zPXtwcm9wcy5pdGVtc30gY2xpY2tlZD17Y2xpY2tlZH0gLz5cclxuICAgICAgICApIDogKFxyXG4gICAgICAgICAgPD48Lz5cclxuICAgICAgICApfVxyXG4gICAgICA8L2Rpdj5cclxuICAgIDwvZGl2PlxyXG4gICk7XHJcbn07XHJcblxyXG5jb25zdCBJdGVtTGlzdCA9IChwcm9wcykgPT4ge1xyXG4gIHJldHVybiAoXHJcbiAgICA8dWwgaWQ9XCJsaXN0XCI+XHJcbiAgICAgIHtwcm9wcy5pdGVtcy5tYXAoKGl0ZW0pID0+IChcclxuICAgICAgICA8SXRlbSBjbGlja2VkPXtwcm9wcy5jbGlja2VkfSBpdGVtPXtpdGVtfT48L0l0ZW0+XHJcbiAgICAgICkpfVxyXG4gICAgPC91bD5cclxuICApO1xyXG59O1xyXG5cclxuZnVuY3Rpb24gU2V0Q2FyZXRBdEVuZChlbGVtKSB7XHJcbiAgaWYgKGVsZW0gPT09IG51bGwpIHJldHVybjtcclxuICB2YXIgZWxlbUxlbiA9IGVsZW0udmFsdWUubGVuZ3RoO1xyXG4gIC8vIEZvciBJRSBPbmx5XHJcbiAgaWYgKGRvY3VtZW50LnNlbGVjdGlvbikge1xyXG4gICAgLy8gU2V0IGZvY3VzXHJcbiAgICBlbGVtLmZvY3VzKCk7XHJcbiAgICAvLyBVc2UgSUUgUmFuZ2VzXHJcbiAgICB2YXIgb1NlbCA9IGRvY3VtZW50LnNlbGVjdGlvbi5jcmVhdGVSYW5nZSgpO1xyXG4gICAgLy8gUmVzZXQgcG9zaXRpb24gdG8gMCAmIHRoZW4gc2V0IGF0IGVuZFxyXG4gICAgb1NlbC5tb3ZlU3RhcnQoXCJjaGFyYWN0ZXJcIiwgLWVsZW1MZW4pO1xyXG4gICAgb1NlbC5tb3ZlU3RhcnQoXCJjaGFyYWN0ZXJcIiwgZWxlbUxlbik7XHJcbiAgICBvU2VsLm1vdmVFbmQoXCJjaGFyYWN0ZXJcIiwgMCk7XHJcbiAgICBvU2VsLnNlbGVjdCgpO1xyXG4gIH0gZWxzZSBpZiAoZWxlbS5zZWxlY3Rpb25TdGFydCB8fCBlbGVtLnNlbGVjdGlvblN0YXJ0ID09IFwiMFwiKSB7XHJcbiAgICBjb25zb2xlLmxvZyhlbGVtKTtcclxuICAgIC8vIEZpcmVmb3gvQ2hyb21lXHJcbiAgICBlbGVtLnNlbGVjdGlvblN0YXJ0ID0gZWxlbUxlbjtcclxuICAgIGVsZW0uc2VsZWN0aW9uRW5kID0gZWxlbUxlbjtcclxuICAgIGVsZW0uZm9jdXMoKTtcclxuICB9IC8vIGlmXHJcbn1cclxuXHJcbmNvbnN0IGlzVGV4dFNlbGVjdGVkID0gKGlucHV0KSA9PiB7XHJcbiAgaWYgKCFpbnB1dCkgcmV0dXJuIGZhbHNlO1xyXG4gIHZhciBzZWxlY3R0eHQgPSBcIlwiO1xyXG4gIGlmICh3aW5kb3cuZ2V0U2VsZWN0aW9uKSB7XHJcbiAgICBzZWxlY3R0eHQgPSB3aW5kb3cuZ2V0U2VsZWN0aW9uKCk7XHJcbiAgfSBlbHNlIGlmIChkb2N1bWVudC5nZXRTZWxlY3Rpb24pIHtcclxuICAgIHNlbGVjdHR4dCA9IGRvY3VtZW50LmdldFNlbGVjdGlvbigpO1xyXG4gIH0gZWxzZSBpZiAoZG9jdW1lbnQuc2VsZWN0aW9uKSB7XHJcbiAgICBzZWxlY3R0eHQgPSBkb2N1bWVudC5zZWxlY3Rpb24uY3JlYXRlUmFuZ2UoKS50ZXh0O1xyXG4gIH1cclxuXHJcbiAgaWYgKHNlbGVjdHR4dCA9PSBcIlwiKSB7XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG4gIHJldHVybiB0cnVlO1xyXG59O1xyXG5cclxuZnVuY3Rpb24gT3JkZXJIaXN0b3J5U2VhcmNoKHByb3BzKSB7XHJcbiAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICBTZXRDYXJldEF0RW5kKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjc2VhcmNoXCIpKTtcclxuICB9LCAxNTApO1xyXG5cclxuICByZXR1cm4gKFxyXG4gICAgPGlucHV0XHJcbiAgICAgIGlkPVwic2VhcmNoXCJcclxuICAgICAgdHlwZT1cInNlYXJjaFwiXHJcbiAgICAgIHBsYWNlaG9sZGVyPVwic2VhcmNoIHNvbWV0aGluZ1wiXHJcbiAgICAgIHZhbHVlPXtwcm9wcy5uYW1lfVxyXG4gICAgICBvbktleVVwPXtmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgIGxldCB2YWwgPSBlLnRhcmdldC52YWx1ZTtcclxuICAgICAgICBwcm9wcy5zZWFyY2goe1xyXG4gICAgICAgICAgdGFyZ2V0OiB7XHJcbiAgICAgICAgICAgIHZhbHVlOiB2YWwsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9fVxyXG4gICAgLz5cclxuICApO1xyXG59XHJcblxyXG5mdW5jdGlvbiBkZWJvdW5jZShmdW5jLCB3YWl0LCBpbW1lZGlhdGUpIHtcclxuICB2YXIgdGltZW91dDtcclxuXHJcbiAgcmV0dXJuIGZ1bmN0aW9uIGV4ZWN1dGVkRnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgY29udGV4dCA9IHRoaXM7XHJcbiAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcclxuXHJcbiAgICB2YXIgbGF0ZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRpbWVvdXQgPSBudWxsO1xyXG4gICAgICBpZiAoIWltbWVkaWF0ZSkgZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIGNhbGxOb3cgPSBpbW1lZGlhdGUgJiYgIXRpbWVvdXQ7XHJcblxyXG4gICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xyXG5cclxuICAgIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGxhdGVyLCB3YWl0KTtcclxuXHJcbiAgICBpZiAoY2FsbE5vdykgZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcclxuICB9O1xyXG59XHJcblxyXG5jbGFzcyBPcmRlckhpc3RvcnlTZWFyY2hWMiBleHRlbmRzIEpTWENvbXBvbmVudCB7XHJcbiAgcmVuZGVyKHByb3BzKSB7XHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgU2V0Q2FyZXRBdEVuZChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3NlYXJjaFwiKSk7XHJcbiAgICB9LCAxMCk7XHJcbiAgICByZXR1cm4gKFxyXG4gICAgICA8aW5wdXRcclxuICAgICAgICBpZD1cInNlYXJjaFwiXHJcbiAgICAgICAgdHlwZT1cInNlYXJjaFwiXHJcbiAgICAgICAgcGxhY2Vob2xkZXI9XCJzZWFyY2ggc29tZXRoaW5nXCJcclxuICAgICAgICBzdHlsZT17eyB3aWR0aDogXCIxMDAlXCIgfX1cclxuICAgICAgICB2YWx1ZT17cHJvcHMubmFtZX1cclxuICAgICAgICBvbktleVVwPXtkZWJvdW5jZShmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgaWYgKCFpc1RleHRTZWxlY3RlZChlKSkge1xyXG4gICAgICAgICAgICBwcm9wcy5zZWFyY2goZSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSwgNTAwKX1cclxuICAgICAgLz5cclxuICAgICk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgQm9vdEpTWCA9IChwcm9wcywgY29udGFpbmVyID0gXCJyb290XCIpID0+IHtcclxuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb250YWluZXIpLmlubmVySFRNTCA9IFwiXCI7XHJcbiAgZG9jdW1lbnRcclxuICAgIC5nZXRFbGVtZW50QnlJZChjb250YWluZXIpXHJcbiAgICAuYXBwZW5kQ2hpbGQoPE9yZGVySGlzdG9yeUNvbnRhaWVyIHsuLi5wcm9wc30gLz4pO1xyXG59O1xyXG4iXX0=
//# sourceMappingURL=index.js.map
